{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CanvasWidget = void 0;\n\nconst React = require(\"react\");\n\nconst TransformLayerWidget_1 = require(\"../layer/TransformLayerWidget\");\n\nconst styled_1 = require(\"@emotion/styled\");\n\nconst SmartLayerWidget_1 = require(\"../layer/SmartLayerWidget\");\n\nvar S;\n\n(function (S) {\n  S.Canvas = styled_1.default.div`\n\t\tposition: relative;\n\t\tcursor: move;\n\t\toverflow: hidden;\n\t`;\n})(S || (S = {}));\n\nclass CanvasWidget extends React.Component {\n  constructor(props) {\n    super(props);\n    this.ref = React.createRef();\n    this.state = {\n      action: null,\n      diagramEngineListener: null\n    };\n  }\n\n  componentWillUnmount() {\n    this.props.engine.deregisterListener(this.canvasListener);\n    this.props.engine.setCanvas(null);\n    document.removeEventListener('keyup', this.keyUp);\n    document.removeEventListener('keydown', this.keyDown);\n  }\n\n  registerCanvas() {\n    this.props.engine.setCanvas(this.ref.current);\n    this.props.engine.iterateListeners(list => {\n      list.rendered && list.rendered();\n    });\n  }\n\n  componentDidUpdate() {\n    this.registerCanvas();\n  }\n\n  componentDidMount() {\n    this.canvasListener = this.props.engine.registerListener({\n      repaintCanvas: () => {\n        this.forceUpdate();\n      }\n    });\n\n    this.keyDown = event => {\n      this.props.engine.getActionEventBus().fireAction({\n        event\n      });\n    };\n\n    this.keyUp = event => {\n      this.props.engine.getActionEventBus().fireAction({\n        event\n      });\n    };\n\n    document.addEventListener('keyup', this.keyUp);\n    document.addEventListener('keydown', this.keyDown);\n    this.registerCanvas();\n  }\n\n  render() {\n    const engine = this.props.engine;\n    const model = engine.getModel();\n    return React.createElement(S.Canvas, {\n      className: this.props.className,\n      ref: this.ref,\n      onWheel: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onMouseDown: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onMouseUp: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onMouseMove: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onTouchStart: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onTouchEnd: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onTouchMove: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      }\n    }, model.getLayers().map(layer => {\n      return React.createElement(TransformLayerWidget_1.TransformLayerWidget, {\n        layer: layer,\n        key: layer.getID()\n      }, React.createElement(SmartLayerWidget_1.SmartLayerWidget, {\n        layer: layer,\n        engine: this.props.engine,\n        key: layer.getID()\n      }));\n    }));\n  }\n\n}\n\nexports.CanvasWidget = CanvasWidget;","map":{"version":3,"mappings":"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","names":["S","styled_1","div","CanvasWidget","React","Component","constructor","props","ref","createRef","state","action","diagramEngineListener","componentWillUnmount","engine","deregisterListener","canvasListener","setCanvas","document","removeEventListener","keyUp","keyDown","registerCanvas","current","iterateListeners","list","rendered","componentDidUpdate","componentDidMount","registerListener","repaintCanvas","forceUpdate","event","getActionEventBus","fireAction","addEventListener","render","model","getModel","Canvas","className","onWheel","onMouseDown","onMouseUp","onMouseMove","onTouchStart","onTouchEnd","onTouchMove","getLayers","map","layer","TransformLayerWidget_1","key","getID","SmartLayerWidget_1","exports"],"sources":["C:\\Users\\nairr\\app-ui\\app-ui\\node_modules\\@projectstorm\\react-canvas-core\\src\\entities\\canvas\\CanvasWidget.tsx"],"sourcesContent":["import * as React from 'react';\nimport { CanvasEngine } from '../../CanvasEngine';\nimport { TransformLayerWidget } from '../layer/TransformLayerWidget';\nimport styled from '@emotion/styled';\nimport { SmartLayerWidget } from '../layer/SmartLayerWidget';\n\nexport interface DiagramProps {\n\tengine: CanvasEngine;\n\tclassName?: string;\n}\n\nnamespace S {\n\texport const Canvas = styled.div`\n\t\tposition: relative;\n\t\tcursor: move;\n\t\toverflow: hidden;\n\t`;\n}\n\nexport class CanvasWidget extends React.Component<DiagramProps> {\n\tref: React.RefObject<HTMLDivElement>;\n\tkeyUp: any;\n\tkeyDown: any;\n\tcanvasListener: any;\n\n\tconstructor(props: DiagramProps) {\n\t\tsuper(props);\n\n\t\tthis.ref = React.createRef();\n\t\tthis.state = {\n\t\t\taction: null,\n\t\t\tdiagramEngineListener: null\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.props.engine.deregisterListener(this.canvasListener);\n\t\tthis.props.engine.setCanvas(null);\n\n\t\tdocument.removeEventListener('keyup', this.keyUp);\n\t\tdocument.removeEventListener('keydown', this.keyDown);\n\t}\n\n\tregisterCanvas() {\n\t\tthis.props.engine.setCanvas(this.ref.current);\n\t\tthis.props.engine.iterateListeners((list) => {\n\t\t\tlist.rendered && list.rendered();\n\t\t});\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.registerCanvas();\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.canvasListener = this.props.engine.registerListener({\n\t\t\trepaintCanvas: () => {\n\t\t\t\tthis.forceUpdate();\n\t\t\t}\n\t\t});\n\n\t\tthis.keyDown = (event) => {\n\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t};\n\t\tthis.keyUp = (event) => {\n\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t};\n\n\t\tdocument.addEventListener('keyup', this.keyUp);\n\t\tdocument.addEventListener('keydown', this.keyDown);\n\t\tthis.registerCanvas();\n\t}\n\n\trender() {\n\t\tconst engine = this.props.engine;\n\t\tconst model = engine.getModel();\n\n\t\treturn (\n\t\t\t<S.Canvas\n\t\t\t\tclassName={this.props.className}\n\t\t\t\tref={this.ref}\n\t\t\t\tonWheel={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonMouseDown={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonMouseUp={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonMouseMove={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonTouchStart={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonTouchEnd={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonTouchMove={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}>\n\t\t\t\t{model.getLayers().map((layer) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<TransformLayerWidget layer={layer} key={layer.getID()}>\n\t\t\t\t\t\t\t<SmartLayerWidget layer={layer} engine={this.props.engine} key={layer.getID()} />\n\t\t\t\t\t\t</TransformLayerWidget>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</S.Canvas>\n\t\t);\n\t}\n}\n"]},"metadata":{},"sourceType":"script"}